a

    {Â§Â½`c*  Ã£                   @   sd  d Z ddlmZ ddlZddlZddlmZ ddlm	Z	 ddl
mZ ddlm
Z
 ddlZddlZddlZddlZddlZddlZddlZddlZddlZddlZddlZddlmZ dd	lmZ d
gZg dÂ¢Zg dÂ¢Zg d
Â¢ZeÂ  Â¡ Z!eÂ "Â¡ Z#e#Â $dÂ¡Z%e#Â &de%d j'Â¡ eÆ’ Z(ddâ€ Z)ddâ€ Z*ddâ€ Z+ddâ€ Z,ddâ€ Z-ddâ€ Z.ddâ€ Z/ddâ€ Z0d d!â€ Z1d"d#â€ Z2dS )$z5
Created on Sun May 30 11:02:31 2021
@author: Ashish
Ã©    )Ãšprint_functionN)Ãšbuild)ÃšInstalledAppFlow)ÃšRequest)ÃšCredentials)ÃšPyDictionary)ÃšSimpleCalculatorz1https://www.googleapis.com/auth/calendar.readonly)ZjanuaryZfebruaryZmarchZaprilZmayZjuneZjulyZaugustZ	septemberZoctoberZnovemberZdecember)ZmondayZtuesdayZ	wednesdayZthursdayZfridayZsaturdayZsunday)ZrdZthÃšstZndÃšvoicesÃšvoicec                  C   sÂ¦   d } t jÂ dÂ¡rtÂ dtÂ¡} | r&| jsâ€| rD| jrD| jrD| Â 	t
Æ’ Â¡ ntÂ dtÂ¡}|j
ddÂ} tddÆ’Â}|Â | Â Â¡ Â¡ W d   Æ’ n1 sÅ 0    Y  tdd| dÂ}|S )	Nz
token.jsonzclient_secret.jsonr   )ÃšportÃšwZcalendarZv3)Zcredentials)ÃšosÃšpathÃšexistsr   Zfrom_authorized_user_fileÃšSCOPESZvalidZexpiredZ
refresh_tokenZrefreshr   r   Zfrom_client_secrets_fileZrun_local_serverÃšopenÃšwriteZto_jsonr   )ZcredsZflowÃštokenÃšserviceÂ© r   ÃºTc:\Users\Sabareesh\Documents\Virtual Assistant\VirtualAsssitant\tkinter_tutorials.pyÃšauthorize_google*   s    
Ã¿,r   c                 C   s  t j Â | t j jÂ Â¡ Â¡}t j Â | t j jÂ Â¡ Â¡}tj}|Â |Â¡}|Â |Â¡}|Â Â¡ j	d|Â 
Â¡ |Â 
Â¡ dddÂÂ Â¡ }|Â dg Â¡}d}|sÅ t
dÆ’ dS |D ]z}|d Â d	|d Â d
Â¡Â¡}	|	Â dÂ¡}
|	|
d |
d
 â€¦ |	|
d d â€¦  d }	t
|	|d Æ’ ||	7 }||d 7 }|d7 }qÅ½|S )NZprimaryTZ	startTime)Z
calendarIdZtimeMinZtimeMaxZsingleEventsZorderByÃšitemsÃš zNo upcoming events found.ÃšstartZdateTimeÃšdateÃšTÃ©   Ã©   Ã©   Ãº ÃšsummaryÃš
)ÃšdatetimeZcombineÃšminÃštimeÃšmaxÃšpytzZUTCZ
astimezoneÃševentsÃšlistZ	isoformatZexecuteÃšgetÃšprintÃšfind)Ãšdayr   r   Zend_dateZutcZ
events_resultr)   Z
returnlistÃševentr   r-   r   r   r   Ãš
get_events<   s,    

Ã¿

(
r0   c                 C   sÂ  | Â  Â¡ } tjÂ Â¡ }| Â dÂ¡dkr$|S d}d}d}|j}| Â Â¡ D ]â‚¬}|tv rZtÂ |Â¡d }q>|t	v rnt	Â |Â¡}q>|Â 
Â¡ râ‚¬t|Æ’}q>tD ]8}|Â 
|Â¡}|dkrâ€zt|d |â€¦ Æ’}W qâ€   Y qâ€0 qâ€q>||jk rÃš|dkrÃš|d }|dkÂr|dkÂr||jk Âr|jd }n|j}|dkÂrr|dkÂrr|dkÂrr|Â Â¡ }	||	 }
|
dk Ârd|
d7 }
| Â dÂ¡dkÂrd|
d7 }
|tÂ |
Â¡ S |dkÂrÅ’tj|||dÂS d S )NÃštodayr   Ã©Ã¿Ã¿Ã¿Ã¿r   Ã©   Ãšnext)Ãšmonthr.   Ãšyear)Ãšlowerr$   r   r1   Ãšcountr6   ÃšsplitÃšMONTHSÃšindexÃšDAYSÃšisdigitÃšintÃšDAY_EXTENTIONSr-   r5   r.   ZweekdayZ	timedelta)Ãštextr1   r.   Zday_of_weekr5   r6   ÃšwordÃšextÃšfoundZcurrent_day_of_weekZdifr   r   r   Ãšget_dateT   sL    





rD   c                  C   s,   dÂ  tjÂ Â¡ Â dÂ¡Â¡} tÂ Â¡  td| dÅ“Æ’S )NzbHI Project Members This is Jarvis here!!.Current time is {}. An exciting day awaits before you .!!Ãº%I:%M %pÃšJarvisÂ©ÃšnameÃšmsg)Ãšformatr$   ÃšnowÃšstrftimeÃšengineÃš
runAndWaitÃšdict)Zwelcome_msgr   r   r   Ãš	first_runÅ’   s
    Ã¿rP   c                 C   s   t Â | Â¡ t Â Â¡  d S )N)rM   ZsayrN   )r@   r   r   r   Ãštalkâ€œ   s    
rQ   c                  C   sÅ¾   d} z~t Â Â¡ Âb}tdÆ’ tÂ |Â¡}tj|d dddÂ} t| Æ’ | g kr^| d d d } | Â Â¡ } nd} W d   Æ’ n1 sv0    Y  W n   Y n0 td	| d
Å“Æ’S )Nr   zlistening...zen-inT)ÃškeyZlanguageZshow_allZalternativer   Z
transcriptÃšYourG   )ÃšsrZ
Microphoner,   ÃšlistenerZlistenZrecognize_googler7   rO   )ÃšcommandÃšsourcer   r   r   r   Ãšfirst_1Ëœ   s     

Ã¿
&rX   c                 C   sd   t j Â Â¡ }t|Æ’Â ddÂ¡d }t|dÆ’Â}|Â | Â¡ W d   Æ’ n1 sH0    Y  tÂ d|gÂ¡ d S )NÃº:Ãº-z	-note.txtr
   znotepad.exe)r$   rK   ÃšstrÃšreplacer   r   Ãš
subprocessÃšPopen)r@   r   Ãš	file_nameÃšfr   r   r   ÃšnoteÂ¬   s
    
(ra   c                  C   s   t dÆ’ tÆ’ } t| d Æ’ dS )Nz%What would you like me to write down?rI   zI've made a note of that.)rQ   rX   ra   )Ãš	note_textr   r   r   Ãšrun_noteÂµ   s    rc   c                  C   sÃ†   t dÆ’ tÆ’ } | d } | Â ddÂ¡} t| Æ’ t| Æ’dkr | Â Â¡ dkr qFq t dÆ’ tÆ’ }d}|d	kr|ttjÂ Â¡ Â 	d
Â¡Æ’dkr|d}t
jd
| â€º Â|d ttjÂ Â¡ Â 	dÂ¡Æ’ttjÂ Â¡ Â 	dÂ¡Æ’| ddÂ d|  S )Nzcan you tell the mobile number?rI   r!   r   Ã©
   TzWhat is the message?r   Ã©<   z%SÃ©(   r   z+91z%Hz%M)Z	wait_timez,I've sent the message to this phone number :)rQ   rX   r\   r,   ÃšlenÃš	isnumericr>   r$   rK   rL   Ãš	pywhatkitÃšsendwhatmsg)Ãšph_norb   Ãšar   r   r   Ãš	whats_runÂ¼   s$     Ã¿Ã¿rm   c                 C   s^  | dkrd}Ân@d| v s d| v r(d}Ân(d| v r@d}|d7 }Ând| v rj| Â  dd	Â¡}d
| }tÂ |Â¡ ÂnÃ¦d| v rÅ½tjÂ Â¡ Â dÂ¡}d
| }ÂnÃ‚d| v rÂ²| Â  dd	Â¡}tÂ |dÂ¡}ÂnÅ¾d| v rÃ†tÂ 	Â¡ }ÂnÅ d| v rÃ°| Â  dd	Â¡}d| }tÂ 
|Â¡ Ân`d| v Âsd| v Âsd| v ÂrFtÂ Â¡ }|j
Âr$d}nd}d| d t|jÆ’ d }Ân
d| v ÂrËœtdÆ’ tÂ Â¡ }tjÂ Â¡ }	t|	Æ’Â  ddÂ¡d }
|Â |
Â¡ |Â Â¡  d }ÂnÂ¸d!| v ÂrÂ¾tÆ’ }t| Æ’}	t|	|Æ’}Ânâ€™d"| v ÂrÃ’tÆ’ }Ân~d#| v ÂrÃ°tÂ d$gÂ¡ d%}Ân`d&| v ÂrtÆ’ }ÂnLd'| v ÂrtÆ’ }Ân8d(| v Ârâ‚¬| Â  d(d	Â¡}d)| v ÂrD|Â  d)d*Â¡}d+| v ÂrZ|Â  d+d*Â¡}tÆ’ }|Â |Â¡ |j}
d,t|
Æ’ }ÂnÃd-| v ÂsÂ¼d.| v ÂsÂ¼d/| v ÂsÂ¼d0| v ÂsÂ¼d1| v ÂsÂ¼d2| v Âr|| Â  d3d	Â¡}|Â  d4d	Â¡}td5| d6 Æ’ tÂ  Â¡ }|d7kÂr|Â !d8Â¡ nl|d9kÂr|Â !d:Â¡ nV|d;kÂr.|Â !d<Â¡ n@|d=kÂrD|Â !d>Â¡ n*|d?kÂrZ|Â !d@Â¡ n|dAkÂrn|Â !dBÂ¡ dC| dD }nÃ”d#| v ÂrÂ tdEÆ’ tÂ d$gÂ¡ d%}nÂ°dF| v ÂrÂ°dG}nÂ dH| v Âr,| Â  dHd	Â¡}|Â  d4d	Â¡}t"Â #|Â¡}dIdJâ€ |Â $Â¡ D Æ’}d	}|D ]&}||dK dL |d dK  dM 7 }ÂqÃ¶t%|Æ’ |}n$dN| v Âs@dO| v ÂrLdP}t&Æ’  ndQ}t'dR|dSÅ“Æ’S )TNzNo command recievedZhelloÃšhizHello sir!!zhow are youzI am fine, Thank youz,How are you, Sir?Ãšsearchr   z
searching r&   rE   zCurrent time is z
tell me aboutr   ZjokeZplayzplaying zbattery percentagezbattery infozbattery informationz
 charging z not charging zYour system is currently z
and it is z	 percent.ztake screenshotzTaking screenshotrY   rZ   z-screenshot.pngzTook the screenshotztell me the eventszopen notepadzopen spotifyzspotify.exezOpened Spotify applicationzmake a notezwrite this downZ	calculateZdivideÃº/ZbyzAnswer is :zopen myanimelistzopen stackoverflowzopen youtubezopen githubzopen nucleuszopen moodler   r!   zOpening z Sir!!Zmyanimelistzhttps://myanimelist.netZ
stackoverflowzhttps://stackoverflow.comZyoutubezhttps://www.youtube.comZgithubzhttps://github.comZnucleuszhttps://nucleus.amcspsgtech.inZmoodlezhttps://moodle.amcspsgtech.inzOpened z in your web browserzOpening Spotify Sir!!zsend a message in whatsappzMessage sending failurezfind the meaning ofc                 S   s   g | ]\}}||fâ€˜qS r   r   )Ãš.0ÃškÃšvr   r   r   Ãš
<listcomp>8  Ã³    zrun_alexa.<locals>.<listcomp>r   z : r#   ÃšrestÃšsleepzAOkay Guys I will just take a nap, Call me whenever u need my helpz#sorry sir!! i cannot understand !!!rF   rG   )(r\   ri   ro   r$   rK   rL   Ãš	wikipediar"   ÃšpyjokesZget_jokeZplayonytÃšpsutilZsensors_batteryZ
power_pluggedrJ   ÃšpercentrQ   ÃšpyscreenshotÃšgrabr[   ÃšsaveÃšshowr   rD   r0   rc   r]   r^   r   ÃšrunZlcdÃš
webbrowserr+   r   Ãš
dictionaryZmeaningr   r,   ÃšexitrO   )rV   ZreplyÃšinpr&   ZpersonZsongZbattery_dataZstrgÃšimager   r_   r   ÃšcÃšdÃšbÃšoutr*   Ãšxr   r   r   Ãš	run_alexaÃ’   sÃ    
Ã¿Ã¿














<










$râ€¹   )3Ãš__doc__Z
__future__r   r$   Zos.pathr   Zgoogleapiclient.discoveryr   Zgoogle_auth_oauthlib.flowr   Zgoogle.auth.transport.requestsr   Zgoogle.oauth2.credentialsr   Zspeech_recognitionrT   Zpyttsx3ri   ry   rx   r]   r|   r(   rÂ   rz   r   Zcalculator.simpler   r   r:   r<   r?   Z
RecognizerrU   ÃšinitrM   ZgetPropertyr
   ZsetPropertyÃšidrâ€š   r   r0   rD   rP   rQ   rX   ra   rc   rm   râ€¹   r   r   r   r   Ãš<module>   sN   
8	